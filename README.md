# Сопротивление - Мультиплеерная игра

Онлайн-версия настольной игры "Сопротивление" для 5-9 игроков с поддержкой игры с разных устройств.

## Особенности

- **Реальное мультиплеерное взаимодействие** через WebSocket
- **Автоматическое распределение ролей** (сопротивление/шпионы)
- **Игра с разных устройств** — достаточно браузера
- **Защищённые комнаты** с паролем и пригласительными ссылками
- **Полноценный игровой процесс** с обсуждением, голосованием, миссиями
- **Адаптивный интерфейс** для компьютеров и мобильных устройств
- **Готовый публичный сервер** на Render: `wss://test-pul.onrender.com`

## Быстрый старт

### Вариант 1: Игра через интернет (рекомендуется)

Используйте готовый публичный сервер — ничего устанавливать не нужно!

1. **Откройте клиент** одним из способов:
   - Перейдите по ссылке на GitHub Pages (если размещено)
   - Или откройте файл `index.html` локально из этого репозитория

2. **Настройте подключение**:
   - Нажмите кнопку **"Настройки"** в правом верхнем углу
   - Введите адрес сервера: `wss://test-pul.onrender.com`
   - Нажмите **"Подключиться"**

3. **Создайте комнату и пригласите друзей**:
   - Войдите под своим именем
   - Создайте комнату (можно с паролем)
   - Скопируйте ссылку-приглашение из окна ожидания
   - Отправьте друзьям ссылку и адрес сервера

### Вариант 2: Локальный запуск (для тестирования)

Если хотите запустить свой сервер:

1. **Установите зависимости**:
   ```bash
   npm install
   ```

2. **Запустите сервер**:
   ```bash
   npm start
   ```
   Сервер запустится на порту 8080. Вы увидите:
   ```
   Server listening on http://localhost:8080
   ```

3. **Подключите клиентов**:
   - Откройте `http://localhost:8080` в браузере
   - Или откройте `index.html` и укажите `ws://localhost:8080` в настройках

## Развёртывание

### Использование публичного сервера (проще всего)

Готовый сервер уже работает по адресу: `wss://test-pul.onrender.com`

Просто укажите этот адрес в настройках клиента — больше ничего делать не нужно!

### Размещение клиента на GitHub Pages

1. **Создайте репозиторий** на GitHub
2. **Загрузите файлы**: `index.html`, `package.json`, `server.js`, `README.md`
3. **Включите GitHub Pages** в настройках репозитория (ветка main, папка /root)

**Важно**: GitHub Pages не поддерживает WebSocket сервер. Клиент автоматически подключится к `wss://test-pul.onrender.com` при открытии с GitHub Pages.

### Запуск своего сервера на Render

Если хотите запустить собственный сервер:

1. **Создайте аккаунт** на [render.com](https://render.com)
2. **Создайте новый Web Service**, подключите GitHub репозиторий
3. **Настройки**:
   - **Build Command:** `npm install`
   - **Start Command:** `npm start`
4. **Получите URL** вида: `wss://ваш-проект.onrender.com`

### Параметры URL для быстрого подключения

Можно создать ссылки с предустановленным сервером:

```
https://ваш-сайт.github.io/репозиторий/?server=wss://test-pul.onrender.com
```

Или для своего сервера:

```
?server=wss://ваш-проект.onrender.com
```

## Игра с разных устройств

### Пример сценария игры:

1. **Создатель игры** (устройство А):
   - Открывает клиент (index.html)
   - В настройках указывает `wss://test-pul.onrender.com`
   - Входит под своим именем
   - Создаёт комнату (можно установить пароль)
   - Копирует **ссылку для приглашения** из окна ожидания

2. **Игроки** (устройства Б, В, Г...):
   - Открывают клиент (index.html)
   - В настройках указывают тот же адрес: `wss://test-pul.onrender.com`
   - Входят по пригласительной ссылке (без пароля)
   - ИЛИ находят комнату в лобби и входят с паролем (если установлен)

3. **Начало игры**:
   - Когда в комнате соберётся 5-9 игроков
   - Создатель нажимает **"Начать игру"**
   - Сервер автоматически распределяет роли
   - Игра начинается!

### Важные моменты:
- **Все игроки должны использовать один и тот же сервер**
- **Пригласительная ссылка работает без пароля** даже для защищённых комнат
- **Можно играть с компьютеров, планшетов и телефонов** одновременно
- **IP-адреса могут быть разными** — игра работает через интернет

## Структура проекта

- `index.html` — клиентское приложение (HTML, CSS, JavaScript)
- `server.js` — серверная часть (Node.js + WebSocket)
- `package.json` — зависимости и скрипты
- `README.md` — эта инструкция

## Технологии

- **Frontend**: HTML5, Tailwind CSS, Vanilla JavaScript
- **Backend**: Node.js, Express, WebSocket (ws)
- **Коммуникация**: WebSocket для реального времени
- **Идентификация**: Device ID в localStorage

## Устранение проблем

### "Нет соединения с сервером"

#### При использовании публичного сервера `wss://test-pul.onrender.com`:

1. **Проверьте статус сервера Render**:
   - Сервер может быть в спящем режиме после периода неактивности
   - Первое подключение может занять 30-60 секунд на "пробуждение"
   - Попробуйте подключиться повторно через минуту

2. **Проверьте адрес WebSocket**:
   - Должен быть `wss://test-pul.onrender.com` (обратите внимание на `wss://`, а не `ws://`)
   - В клиенте нажмите "Настройки" и убедитесь, что адрес указан правильно

3. **Проверьте интернет-соединение**:
   - Убедитесь, что есть доступ в интернет
   - Попробуйте открыть другие сайты

#### При локальном запуске:

1. **Убедитесь, что сервер запущен**:
   ```bash
   # В терминале должна быть надпись:
   # Server listening on http://localhost:8080
   ```

2. **Проверьте порт**:
   - Порт 8080 может быть занят. Используйте другой порт:
     ```bash
     PORT=8081 npm start
     ```
   - Затем в клиенте укажите `ws://localhost:8081`

3. **Проверьте брандмауэр**:
   - Разрешите входящие подключения на выбранном порту

### Игра не начинается

- Требуется **минимум 5 игроков** в комнате
- Начать игру может только **создатель комнаты** (хост)
- Убедитесь, что все игроки в одной комнате (видят друг друга в списке)

### Игроки не видят друг друга

- Убедитесь, что **все игроки используют один и тот же сервер**
- Проверьте, что нет проблем с интернет-соединением
- Попробуйте переподключиться к серверу

### Медленная работа или задержки

- Публичный сервер на бесплатном тарифе Render может иметь ограничения
- Для лучшей производительности запустите собственный сервер
- При локальной игре в одной сети задержки минимальны

## Разработка

Для разработки с автоперезагрузкой:

```bash
npm run dev
```

Требуется nodemon (установится автоматически с `npm install`).

## Лицензия

MIT